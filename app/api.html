<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HiGlass</title>
<style type="text/css">
.canvasjs-chart-credit {
  display:none;
}
</style>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css">
<link rel="stylesheet" href="styles/page.css">
<link rel="stylesheet" href="hglib.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.6.2/react.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/15.6.2/react-dom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.6.2/pixi.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-bootstrap/0.32.0/react-bootstrap.js"></script>
</head>
<body >
  <div style="height: 50px" />
    <div style="margin: auto; width: 100%;">
    <div
      id="development-demo"
      style="position: absolute; left: 1rem; top: 1rem; bottom: 1rem; right: 1rem">
    </div>
  </div>
</body>
<script src='hglib.js'>
</script>
<script>

const testViewConfig = {
  editable: true,
  zoomFixed: false,
  trackSourceServers: ['http://higlass.io/api/v1'],
  exportViewUrl: 'http://higlass.io/api/v1/viewconfs/',
  views: [
    {
      uid: 'aa',
      initialXDomain: [
        0,
        3100000000
      ],
      autocompleteSource: 'http://higlass.io/api/v1/suggest/?d=OHJakQICQD6gTD7skx4EWA&',
      genomePositionSearchBoxVisible: true,
      chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',
      tracks: {
        top: [
          {
            type: 'horizontal-gene-annotations',
            height: 60,
            tilesetUid: 'OHJakQICQD6gTD7skx4EWA',
            server: 'http://higlass.io/api/v1',
            position: 'top',
            uid: 'OHJakQICQD6gTD7skx4EWA',
            name: 'Gene Annotations (hg19)',
            options: {
              name: 'Gene Annotations (hg19)'
            },
            maxWidth: 4294967296,
            maxZoom: 22
          },
          {
            chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',
            type: 'horizontal-chromosome-labels',
            position: 'top',
            name: 'Chromosome Labels (hg19)',
            height: 30,
            uid: 'I1QUF22JQJuJ38j9PS4iqw',
            options: {}
          }
        ],
        left: [
          {
            type: 'vertical-gene-annotations',
            width: 60,
            tilesetUid: 'OHJakQICQD6gTD7skx4EWA',
            server: 'http://higlass.io/api/v1',
            position: 'left',
            name: 'Gene Annotations (hg19)',
            options: {
              labelPosition: 'bottomRight',
              name: 'Gene Annotations (hg19)'
            },
            uid: 'OgnAEKSHRaG-gR1RqPOuBQ',
            maxWidth: 4294967296,
            maxZoom: 22
          },
          {
            chromInfoPath: '//s3.amazonaws.com/pkerp/data/hg19/chromSizes.tsv',
            type: 'vertical-chromosome-labels',
            position: 'left',
            name: 'Chromosome Labels (hg19)',
            width: 30,
            uid: 'a-mFiHnBQ8uuI6UG3USWVA',
            options: {}
          }
        ],
        center: [
          {
            uid: 'c1',
            type: 'combined',
            height: 200,
            contents: [
              {
                server: 'http://higlass.io/api/v1',
                tilesetUid: 'CQMd6V_cRw6iCI_-Unl3PQ',
                type: 'heatmap',
                position: 'center',
                options: {
                  colorRange: [
                    '#FFFFFF',
                    '#F8E71C',
                    '#F5A623',
                    '#D0021B'
                  ],
                  maxZoom: null,
                  labelPosition: 'bottomRight',
                  name: 'Rao et al. (2014) GM12878 MboI (allreps) 1kb'
                },
                uid: 'Ou4CIWdfSOqAucehIgPwgA',
                name: 'Rao et al. (2014) GM12878 MboI (allreps) 1kb',
                maxWidth: 4194304000,
                binsPerDimension: 256,
                maxZoom: 14
              }
            ],
            position: 'center',
            options: {}
          }
        ],
        right: [],
        bottom: []
      },
      initialYDomain: [
        756976744.1860464,
        2343023255.8139534
      ],
      layout: {
        w: 12,
        h: 12,
        x: 0,
        y: 0,
        i: 'aa',
        moved: false,
        static: false
      }
    }
  ],
  zoomLocks: {
    locksByViewUid: {},
    locksDict: {}
  },
  locationLocks: {
    locksByViewUid: {},
    locksDict: {}
  }
};

const higlass = window.hglib.viewer(
  document.getElementById('development-demo'),
  'http://higlass.io/api/v1/viewconfs/?d=default',
  { bounded: true }
);

higlass.on('location', (yeahCool) => {
  console.log('Yuuhuu we are over here', yeahCool);
}, 'aa', (id) => {
  console.log('First Listener ID', id);
});

let secondId;

higlass.on('location', (yeahCool) => {
  console.log('Dont forget about us sweetie', yeahCool);
}, 'aa', (id) => {
  secondId = id;
  console.log('Second Listener ID', id);
});

setTimeout(() => {
  higlass.off('location', secondId, 'aa');
  console.log('Second event listener is offline');
}, 5000);

let prevViewConfig;
higlass.on('viewConfig', (newViewConfig) => {
  console.log('And here it is: a new view config! YEAH!', prevViewConfig === newViewConfig);
});

const mmz = higlass.on('mouseMoveZoom', (data) => {
  console.log('Yuuhuu', data);
});

setTimeout(() => {
  higlass.off('mouseMoveZoom', mmz);
  console.log('mouseMoveZoom is offline', mmz);
}, 5000);

</script>
</html>
